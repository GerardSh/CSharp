# General
## Steps In Database Design
### Identify Entities
Ентитито е обект, който е важен за бизнеса. Най-лесния вариант да определим ентититата, когато започнем да правим дизайна на базата ни данни идва от DDD (Domain Driven Design), където domain-a е бизнес област в която работи нашия software. Трябва да започнем изграждането на речник като започнем разговор с експерти в областта. 

Примерно, ако правим приложение за градския транспорт, по време на разговора си изваждаме domain specific думи като спирки, автобуси, билети, контрольори, маршрути, разписание и тн. Тези думички са ентититата и съответстват на таблиците в базата данни. Най-често са съществителни във спецификацията и каквото и да прочетем в нея, трябва да говорим и със специалистите във въпросната област.

Друг пример - трябва да разработим система, която съхранява информация за студенти, обучаващи се в различни курсове. Курсовете се провеждат в различни градове. При регистриране на нов студент се въвежда следната информация: име, факултетен номер, снимка и дата.

Entities: Student, Course, Town.
### Identify Table Columns
Има колони, които са служебни и са задължителни. Домейн специфичните колони, се намират най-лесно отново в процеса на разговора като обсъдим ентититата, примерно спирката си има адрес, номерация, състояние, връзка с автобусите, които спират там и тн. 
В примера със студентите, всеки студент си има име, но има детайли, които трябва да се обсъдят, като това когато студента влиза в системата, дали тя се обръща към него с цялото му име или само фамилия и тн. 
Друг детайл е дали и трите имена да се включват в сертификатите. Ние като IT експерти, трябва да преценим как точно, къде, до каква степен имаме право да съхраняваме данните и тн.

Добре е да има допълнителни колони, примерно колона която пази датата на създаване на даден запис, кой го е създал и тн. Това са специални колони, които е добра практика да се създават.
### How to Choose a Primary Key
Първичния ключ е едно от най-важните неща в една таблица. Важен е защото, това е нещото, което еднозначно идентифицира записа. Той е абсолютно уникален и е начина, по който достъпваме правилните данни. Много хора правят грешката да използват бизнес термини. Това е голяма грешка, защото колкото и бизнеса да ни уверява че нещо е уникално и то ще остане винаги такова, не трябва да му се вярва. Затова бизнес данните, не трябва да се ползват като ключ, за да се избегне колизия.

В повечето случаи ключът трябва да бъде число, защото числата се обработват бързо. Понякога това не е достатъчно поради огромния обем на генерираните данни, и тогава дори `long` (64 бита) не е достатъчен. В краен случай може да се използва `GUID` (Globally Unique Identifier 128 бита). Той също работи бързо и не може да бъде отгатнат, което е важно, тъй като съществуват атаки, базирани на ID-та.

Ако ползваме цяло число, primary key-a задължително трябва да е `IDENTITY` с auto-increment. Базата данни е среда на силна конкурентност и ако ние даваме числата, може да се дублират, докато базата е проектирана в среда на конкурентост да ги създава сама, без да ги дублира. Може да се получи дупка в идентификатора, ако възникне грешка, но няма да има дублиране. 
При `GUID` `IDENTITY` не работи, защото `GUID` не е последователен тип данни. `GUID` стойностите са случайно или псевдослучайно генерирани и не се вписват в концепцията за автоматично увеличаване. Ако обаче искаме да използваме `GUID` като ключ, можем да използваме други механизми, като например:
- `NEWID()`: Функция, която генерира уникален `GUID` за всяка нова стойност.
- `NEWSEQUENTIALID()`: Функция, която генерира `GUID` с последователност, за да се оптимизира производителността при индексиране.

Primary key-a, трябва да е първа колона. След създаването на таблицата, колоните не може да се пренареждат.

Не е добре да се ползва текст, защото се създава по-неефективни индекси, а те са много важни, защото се търси бързина - много бързо да може да се изкарат данните. При текстови индекси, нещата са доста по-зле от колкото при числови индекси.


# Misc

# ChatGPT

# Bookmarks
Completion: 06.01.2025