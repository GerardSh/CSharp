# General
## SQL Functions
Имаме различни типове функции в SQL и когато ги ползваме е добре да знаем върху какви данни го правим.
Функциите може да бъдат вграждани една в друга.
### Aggregate functions
SQL е език, който не само трябва да се грижи за CRUD операциите в нашата база данни, но до голяма степен да ни дава възможност и да използваме тези данни. Има в себе си вградена функционалност за по-сложни анализи на данните, като агрегацията е една от тях. Когато правим агрегации, трябва да ги правим върху правилните данни.
Такива агрегиращи функции са: AVG, COUNT, MIN, MAX, SUM и други.
### Analytic functions
Предоставят възможност да се изчисляват стойности въз основа на група редове, но за разлика от стандартните агрегиращи функции, те не свеждат резултата само до една стойност за групата, а запазват оригиналните редове в резултатите. Тези функции са мощни инструменти за анализ на данни. Много рядко са необходими.
### Ranking functions
Аналитични функции, които подреждат редовете в рамките на дефиниран прозорец.
Такива функции са: RANK, ROW_NUMBER, DENSE_RANK, NTILE и други, като ROW_NUMBER е най-често използваната.
### Rowset functions
Връщат набор от редове (result set) и обикновено се използват за работа с таблици, представяне на външни данни или генериране на данни. Те могат да се използват в `FROM` или `JOIN` клаузите на заявките.
### Scalar functions
Задължително връщат единична стойност, което означава, че може да ги ползваме в `SELECT`.
### String Functions
`CONCAT` - заменя `NULL` стойности с празен стринг `''` така че да не повлияе на крайния резултат.

```sql
SELECT CONCAT('Hello', ' ', NULL, 'World') AS Result;
-- Result: Hello World
```

---
`CONCAT_WS` - обединява стринговете със зададен сепаратор.. Ако има `NULL` стойност, не я включва, докато ако ползваме само `CONCAT` ще добави празен стринг.

```sql
SELECT CONCAT_WS(' ', 'Hello', NULL, 'World') AS Result;
-- Result: Hello World
```

При някои ситуации, използвайки `CONCAT` ще получим повече празни пространства, примерно:

```sql
SELECT CONCAT(FirstName, ' ', MiddleName, ' ', LastName) AS [Full Name] FROM Employee
```

Проблема в примера е, че ако `MiddleName` е `NULL`, тогава ще бъде заменен с празен стринг, но сепараторите `' '` ще останат и ще получим две празни пространства вместо едно, между `FirstName` и `LastName`.

---
`SUBSTRING(String, StartIndex, Length)` - извлича част от стринг, като започва от началния индекс спрямо зададената дължина, като индексирането започва от 1 а не от 0.

Подхода в долния пример е полезен за показване на кратка част от текста в списъци или прегледи на статии, без да се показва цялото съдържание:

```sql
SELECT ArticleId, Author, Content,
SUBSTRING(Content, 1, 200) + '...' AS Summary
FROM Articles
```

---
`REPLACE(String, Pattern, Replacement)` - заменя даден стринг с друг.

В примера цензурираме думата 'blood':

```sql
SELECT REPLACE(Title, 'blood', '*****’) AS Title FROM Album
```

---
`LTRIM(string, trim_characters)` & `RTRIM(string, trim_characters)` - тези функции премахват водещи и завършващи символи от даден стринг. По подразбиране премахват празни пространства, но могат да се зададат конкретни символи за премахване. Аргумента `trim_characters` не е задължителен.

В примера се премахват всички `+` и `-` символи в края на стринга. Ако между тези символи имаше друг знак, премахването щеше да спре при първия срещнат символ, който не е част от зададения списък.

```sql
SELECT RTRIM('test-++--+--+', '+-')
```

---
`TRIM([LEADING | TRAILING | BOTH] trim_characters FROM string)` - премахва водещи и/или завършващи символи от даден низ. Ако използваме `TRIM` без аргументи, ще премахне **само водещите и завършващите празни пространства** от стринга. Няма да премахне други символи.

- **`LEADING`**: Премахва само водещи символи.
- **`TRAILING`**: Премахва само завършващи символи.
- **`BOTH`** (по подразбиране): Премахва символите и от двете страни.
- **`trim_characters`**: Символите, които да бъдат премахнати (по подразбиране е празно пространство).

Пример:

```sql
SELECT TRIM(BOTH '+-' FROM '-+-test-+-');
```
# Misc

# ChatGPT

# Bookmarks
Completion: 11.01.2025